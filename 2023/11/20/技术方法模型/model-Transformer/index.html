<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Transformer | chiblog</title><meta name="author" content="神经蛙"><meta name="copyright" content="神经蛙"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[Public, Approved] Intro to Transformers - Google Slides 目前，主流的多模态大模型大多以Transformer为基础。Transformer是一种由谷歌在2017年提出的深度学习模型，主要用于自然语言处理（NLP）任务，特别是序列到序列（Sequence-to-Sequence）的学习问题，如文本生成。Transformer彻底改变了之前基于">
<meta property="og:type" content="article">
<meta property="og:title" content="Transformer">
<meta property="og:url" content="https://chierhy.github.io/2023/11/20/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/model-Transformer/index.html">
<meta property="og:site_name" content="chiblog">
<meta property="og:description" content="[Public, Approved] Intro to Transformers - Google Slides 目前，主流的多模态大模型大多以Transformer为基础。Transformer是一种由谷歌在2017年提出的深度学习模型，主要用于自然语言处理（NLP）任务，特别是序列到序列（Sequence-to-Sequence）的学习问题，如文本生成。Transformer彻底改变了之前基于">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg">
<meta property="article:published_time" content="2023-11-20T02:17:00.000Z">
<meta property="article:modified_time" content="2024-07-11T02:06:27.000Z">
<meta property="article:author" content="神经蛙">
<meta property="article:tag" content="笔记🎫">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg"><link rel="shortcut icon" href="https://pic4.zhimg.com/v2-da217cabde0a382120e68118571d60e3_r.jpg"><link rel="canonical" href="https://chierhy.github.io/2023/11/20/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/model-Transformer/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Transformer',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-11 10:06:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="chiblog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://github.com/chierhy/chierhy.github.io/blob/master/%E9%99%84%E4%BB%B6/1.jpg?raw=true" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">120</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">chiblog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Transformer</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-20T02:17:00.000Z" title="发表于 2023-11-20 10:17:00">2023-11-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-11T02:06:27.000Z" title="更新于 2024-07-11 10:06:27">2024-07-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A7%91%E7%A0%94/">科研</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Transformer"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://docs.google.com/presentation/d/1ZXFIhYczos679r70Yu8vV9uO6B1J0ztzeDxbnBxD1S0/edit#slide=id.g13dd67c5ab8_0_2543">[Public, Approved] Intro to Transformers - Google Slides</a></p>
<p>目前，主流的多模态大模型大多以Transformer为基础。Transformer是一种由谷歌在2017年提出的深度学习模型，主要用于自然语言处理（NLP）任务，特别是序列到序列（Sequence-to-Sequence）的学习问题，如文本生成。Transformer彻底改变了之前基于循环神经网络（RNNs）和长短期记忆网络（LSTMs）的序列建模范式，并且在性能提升上取得了显著成效。Transformer结构如下图所示：</p>
<p><img src="https://img-blog.csdnimg.cn/direct/243dde6edf8647a1bc180d90775d97f3.png" alt="在这里插入图片描述"><br><strong>Transformer的核心构成包括：</strong></p>
<p><strong>自注意力机制（Self-Attention Mechanism）</strong>：Transformer模型摒弃了传统RNN结构的时间依赖性，通过自注意力机制实现对输入序列中任意两个位置之间的直接关联建模。每个词的位置可以同时关注整个句子中的其他所有词，计算它们之间的相关性得分，然后根据这些得分加权求和得到该位置的上下文向量表示。这种全局信息的捕获能力极大地提高了模型的表达力。</p>
<p><strong>多头注意力（Multi-Head Attention）</strong>：Transformer进一步将自注意力机制分解为多个并行的“头部”，每个头部负责从不同角度对输入序列进行关注，从而增强了模型捕捉多种复杂依赖关系的能力。最后，各个头部的结果会拼接并经过线性变换后得到最终的注意力输出。</p>
<p><strong>位置编码（Positional Encoding）</strong>：由于Transformer不再使用RNN的顺序处理方式，为了引入序列中词的位置信息，它采用了一种特殊的位置编码方法。这种方法对序列中的每个位置赋予一个特定的向量，该向量的值与位置有关，确保模型在处理过程中能够区分不同的词语顺序。</p>
<p><strong>编码器-解码器架构（Encoder-Decoder Architecture）</strong>：Transformer采用了标准的编码器-解码器结构，其中，编码器负责理解输入序列，将其转换成高级语义表示；解码器则依据编码器的输出，结合自身产生的隐状态逐步生成目标序列。在解码过程中，解码器还应用了自注意力机制以及一种称为“掩码”（Masking）的技术来防止提前看到未来要预测的部分。</p>
<p><strong>残差连接（Residual Connections）</strong>：Transformer沿用了ResNet中的残差连接设计，以解决随着网络层数加深带来的梯度消失或爆炸问题，有助于训练更深更复杂的模型。</p>
<p><strong>层归一化（Layer Normalization）</strong>：Transformer使用了层归一化而非批量归一化，这使得模型在小批量训练时也能获得良好的表现，并且有利于模型收敛。</p>
<h1 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h1><ol>
<li>Transfomer结构介绍一下</li>
<li>对Q, K, V的理解？</li>
<li>对多头注意力中多头的理解？为什么用多头注意力机制，优势在哪里</li>
</ol>
<ul>
<li>BERT的预训练过程讲一下。</li>
<li>BERT做MASK的策略？（取15%的词进行计算损失；80%掩码，10%替换为随机词，10%保持不变）</li>
<li>BERT的Embedding？（三个）</li>
<li>BERT为什么使用LayerNorm而不使用BatchNorm</li>
<li>Transformer做句子生成怎么做？</li>
<li>注意力计算</li>
<li>attention里面的softmax和普通的softmax有什么不同</li>
<li>attention里面q和k的转置的乘积结果除以根号k，k是什么?</li>
</ul>
<hr>
<h2 id="ans"><a href="#ans" class="headerlink" title="ans"></a>ans</h2><h4 id="Transformer"><a href="#Transformer" class="headerlink" title="Transformer"></a>Transformer</h4><ol>
<li><p><strong>Transformer结构介绍</strong></p>
<ul>
<li><strong>回答</strong>：Transformer由编码器和解码器组成。编码器由多个相同的层叠加而成，每层包括自注意力机制和前馈神经网络。解码器也由多个相同的层叠加而成，每层包括自注意力机制、编码器-解码器注意力机制和前馈神经网络。</li>
</ul>
</li>
<li><p><strong>对Q, K, V的理解</strong></p>
<ul>
<li><strong>回答</strong>：Q（Query）、K（Key）和V（Value）是注意力机制中的三个矩阵。Q代表查询向量，K代表键向量，V代表值向量。注意力机制通过Q和K的点积计算相似度，决定V的加权平均。</li>
</ul>
</li>
<li><p><strong>对多头注意力中多头的理解及优势</strong></p>
<ul>
<li><strong>回答</strong>：多头注意力通过并行的多个注意力头捕捉不同子空间的信息，提高模型对特征的表达能力和稳定性。相比单头注意力，多头注意力更能捕捉复杂的模式和长距离依赖。</li>
</ul>
</li>
</ol>
<h4 id="BERT"><a href="#BERT" class="headerlink" title="BERT"></a>BERT</h4><ol>
<li><p><strong>BERT的预训练过程</strong></p>
<ul>
<li><strong>回答</strong>：BERT通过Masked Language Model（MLM）和Next Sentence Prediction（NSP）进行预训练。MLM随机遮盖输入文本中的一些词，然后预测它们；NSP预测两个句子是否连续。</li>
</ul>
</li>
<li><p><strong>BERT做MASK的策略</strong></p>
<ul>
<li><strong>回答</strong>：BERT的MASK策略是取15%的词进行计算损失，其中80%用[MASK]替换，10%替换为随机词，10%保持不变。</li>
</ul>
</li>
<li><p><strong>BERT的Embedding</strong></p>
<ul>
<li><strong>回答</strong>：BERT的Embedding包括词嵌入（Word Embeddings）、位置嵌入（Position Embeddings）和分段嵌入（Segment Embeddings）。</li>
</ul>
</li>
<li><p><strong>BERT为什么使用LayerNorm而不使用BatchNorm</strong></p>
<ul>
<li><strong>回答</strong>：LayerNorm对每个样本独立标准化，适用于序列模型；而BatchNorm依赖于批量数据，在变长序列中效果不佳。</li>
</ul>
</li>
</ol>
<h4 id="Transformer句子生成"><a href="#Transformer句子生成" class="headerlink" title="Transformer句子生成"></a>Transformer句子生成</h4><ol>
<li><strong>Transformer做句子生成</strong><ul>
<li><strong>回答</strong>：使用解码器部分生成句子。解码器逐步生成每个词，通过注意力机制和前面生成的词预测下一个词，直到生成结束符。</li>
</ul>
</li>
</ol>
<h4 id="注意力计算"><a href="#注意力计算" class="headerlink" title="注意力计算"></a>注意力计算</h4><ol>
<li><p><strong>attention里面的softmax和普通的softmax有什么不同</strong></p>
<ul>
<li><strong>回答</strong>：attention中的softmax作用在Q和K的点积结果上，进行归一化处理，使得所有注意力权重之和为1。普通softmax用于分类任务，对输入进行指数归一化。</li>
</ul>
</li>
<li><p><strong>attention里面q和k的转置的乘积结果除以根号k，k是什么？</strong></p>
<ul>
<li><strong>回答</strong>：k是Q和K的向量维度。除以根号k用于缩放，防止点积结果过大导致梯度消失，提高训练稳定性。</li>
<li></li>
</ul>
</li>
</ol>
<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/bYqOnT12FvmRN2Zb2w_4TQ">一文读懂 Transformer 神经网络模型 (qq.com)</a><br>【Transformer】10分钟学会Transformer | Pytorch代码讲解 | 代码可运行<br>【Huggingface Transformers】保姆级使用教程—上</p>
</blockquote>
<ul>
<li>Transformers implement an attention-based encoder-decoder architecture for sequence analysis. Attention mechanisms [32] learn to aggregate information from the entire sequence，By stacking attentional layers which scan the sequence, Transformers generate a position and context aware representations. This method was shown to outperform recurrent neural networks (RNNs) and LSTMs for various sequence-based problems in Natural Language Understanding and Computer Vision, achieving state-of-the-art performance</li>
<li>, the transformer model in the present study allows one to traverse the time series arbitrarily, since all the contextual relationships are calculated in parallel. When the attention mask is defined, the transformer model can search for connections among the features in the time series both in the direction from past to future, as well as in the opposite direction from future to past, according to the trained attention matrix. ——Using attention blocks, the transformer directly focuses on predicting the intensity of the gain&#x2F;loss of the feature during the feed-forward phase based on the context found during the learning process. Two-dimensional convolutional networks work directly on the principle of the image classifier, and thus learn to recognize hidden patterns in signal frames and predict activities from them. The transformer model is a universal architecture used similarly to convolutional neural networks in NLP, vision, or signal processing tasks.当前的手稿涉及深度神经网络直接应用于来自传感器的信号的归一化时间序列。这项研究采用了一种完全基于注意力机制的流转时长序列的替代方法，称为变压器。变压器模型直接专注于使用注意力机制来寻找特征之间的时间序列中的相关性，并允许时间序列计算的大规模并行化，这与连续迭代时间序列的递神经归网络相比是不同的。变压器的另一个优点是时间序列中特征之间的更长路径长度，这允许更准确地学习长时间序列中的上下文，这是Vaswani等人提出的断言。[34]。计算速度以及预测准确性是处理人类活动的关键要素，其中预测可以直接在移动设备上执行。sequence-to-sequence方法用于预测活动[35]，其中考虑来自变压器输出的所有时间步长并为其分配活动指定。这样，可以将活动分配给用户在测量来自移动设备的实时值时所采取的每个时间步长。——视觉变压器模型的例子已经展示了变压器模型如何有效地取代现有的循环和卷积神经网络。视觉变压器模型以图像的形式处理信号，这支持了这样一个假设，即它也可以处理来自传感器（如加速度计或陀螺仪）的一维时间序列信号。进一步提出的用于人类活动识别的变压器模型直接基于视觉变压器模型架构[43]，然而，其中信号作为输入直接馈入编码器块，同时添加的信息确定信号时间序列中特征的位置。用于人类活动识别的变压器模型以sequence-to-sequence模式运行，并为每个时间序列特征预测类，见图1。优点是，如果一个时间序列中有几个连续的类，这些类可以很容易地识别，变压器不限于整个时间序列中属于一个类的特征。所有完全连接的层都使用均方差为0.02的截断正态分布进行初始化，如BEIT[44]中所示。在信号作为输入馈送到神经网络之前，它会通过一个归一化层，该层存储从训练数据中获得的均值和方差，并将输入调整为0.0均值和1.0均方差的值。这种解决方案的优点是，当模型投入实际使用时，它已经包含了这些校准值，不需要以外部方式解决信号调整。该模型已经完全准备好在移动设备中实施，前提是测量的量在基本物理单元中，加速度计在m&#x2F;s2中，陀螺仪在rad&#x2F;s中。模型的输出层是线性的，在功能不太强大的设备上提供比使用softmax函数时更高的计算速度。原则上，预测活动对应的最大值也可以在应用softmax之前获得，它只在损失函数中的学习期间使用。这种形式在那里使用，由于使用对数的计算，因为它在输出处没有负数，就像线性层一样。</li>
<li>Transformer 特征抽取器：Transformer 模型最早由谷歌在 2017 年提出，属于深度学习模型架构的一种，特点是在学习中引入了注意力机制。对比循环神经网络 (RNN)来看，Transformer 与 RNN 均对输入数据，如自然语言等，进行顺序处理，并主要应用于翻译和文本摘要等工作。但 Transformer 与 RNN 不同的是，Transformer 中的注意机制可以为输入序列中的任何字符提供上下文，因此可以一次处理所有输入，而不是一次只处理一个词。因此，与 RNN 相比，Transformer 可以实现更大规模的并行计算，大大减少了模型训练时间，使得大规模 AI 模型得以被应用。</li>
<li>是一种神经结构，它利用注意力通过一系列步骤对顺序数据进行并行处理。在每一步中，注意机制从前一步序列中选择和组合元素，以可微和5ot 约束的方式对序列中的每个位置形成新的表示。主要出现在自然语言处理 Q 领域，也已成功应用于各类问题。虽然 transformer 结合图形神经网络和语言模型，但 transformer 的运行时间和内存占用可以随着序列的长度二次扩展，导致 long-range 建模和线性注意力机制°被用作去解决效率问题。因此，无监督或自监督生成预训练变压器，然后是参数有效微调，被广泛使用。</li>
<li>Transformer 解码模块是 GPT 模型的核心要建。从 Transformer 架构细节来看，核心是由编码模块和解码模块构成，而 GPT 模型只用到了解码模块。拆解模块来看，大致分为三层：前馈神经网络层、编码&#x2F;解码自注意力机制层（Self-Attention）、自注意力机制掩码层。其中，自注意力机制层主要作用在于计算某个单词对于全部单词的权重（即 Attention），掩码层则需要在这一过程中帮助模型屏蔽位于计算位置右侧尚未出现的单词，最后输出的向量结果输入前馈神经网络，完成模型参数计算。<ul>
<li>BERT 模型在结构上是一个多层的双向 transformer 的 Encoder 模型，GPT 是由 12 个 Transformer 中的 Decoder 模块经修改后组成。相比来说，BERT 模型的核心优势在于自然语言理解，GPT 模型的核心优势在于自然语言生成</li>
</ul>
</li>
</ul>
<p>关键特点包括：</p>
<ol>
<li><p><strong>自注意力机制（Self-Attention）：</strong> Transformer 使用了自注意力机制，使模型能够在输入序列中的不同位置关注不同程度的信息。这使得模型能够并行处理输入序列，提高了训练效率。</p>
</li>
<li><p><strong>无需序列顺序：</strong> 传统的循环神经网络（RNN）和长短时记忆网络（LSTM）等在处理序列数据时需要按顺序逐步处理。而 Transformer 具有并行处理的能力，无需按顺序处理输入序列。</p>
</li>
<li><p><strong>编码器-解码器结构：</strong> Transformer通常用于序列到序列的任务，例如机器翻译。它包含一个编码器（用于处理输入序列）和一个解码器（用于生成输出序列）。字向量加上 位置信息得到Encoder的输入 矩 阵。位置信息Positional Encoding是固定公式计算出来的，值 不会改变，每次有数据来了直接加上 Positional Encoding矩阵就行. 为什 么需要在Embedding加上Positional Encoding？与RNN相比，RNN是一个 字一个字的输入，自然每个字的顺序关 系信息就会保留下来。但在Encoder 中，一个句子的每一个字（词）是并行 计算的（下一节解释），所以我们在输 入的时候需要提前引入位置信息。 思想：先计算出第一个字与句 子中的每一个字的注意力分数（包括第 一个字），再用计算出的注意力分数乘 以对应字的信息，然后加在一起，得到 的结果就是第一个字与句子中所有字的 加权和，依次更新每一个字与句子的注 意力信息。</p>
</li>
<li><p><strong>多头注意力（Multi-Head Attention）：</strong> 为了更好地捕捉不同层次的语义信息，Transformer中的注意力机制可以分为多个头。每个头学习关注输入序列的不同部分，最后进行合并。Multi-Head Attention，它与单头注意力不同的就 是把原来 Q,K,V 三个大矩阵拆分成8个 形状相同的小矩阵（在特征维度上拆 分），也就是8头注意力。 Add是用 了残差神经网络的思想，也就是把 Multi-Head Attention的输入的 a 矩 阵直接加上Multi-Head Attention的 输出 b 矩阵（好处是可以让网络训练的 更深。Layer Normalization和Batch Normalization的区别：Layer Normalization：是在一个句上的进行 归一化。Batch Normalization：是把 每句话的同一维度上的字看成一组做归 一化。  ————Encoder 的 Multi-Head Attention 的 结构和 Decoder 的 Multi-Head Attention 的结构也是一样的，只是 Decoder 的 Multi-Head Attention 的 输入来自两部分，K，V 矩阵来自 Encoder的输出，Q 矩阵来自 Masked Multi-Head Attention 的输出</p>
</li>
<li><p><strong>位置编码：</strong> 由于自注意力机制无法直接捕捉序列中元素的顺序信息，Transformer 使用位置编码来注入序列元素的位置信息。</p>
</li>
<li><p>mask的作用</p>
<ol>
<li>第一种情况：mask作用是去掉 没有意义的字，例如在中文数据集预 处理的时候，中文字有几万个，但是 常用只有几千个，为了较小模型复杂 度和增加网络的泛化能力，就需要把 一些生僻字用padding替换。其次为 了并行计算，保证每一个句子长度一</li>
</ol>
</li>
<li><p>单头注意力机制 和 多头注意力 机制的区别？ 区别：求注意力分数时，单头是整行求 softmax，多头是分段求softmax</p>
</li>
<li><p>任务</p>
<ol>
<li>Transformers 中有许多不同的架构可 用，每一种架构都围绕着处理特定任务 而设计，清单： *Model (retrieve the hidden states) *ForCausalLM *ForMaskedLM *ForMultipleChoice *ForQuestionAnswering *ForSequenceClassification *ForTokenClassification and others</li>
</ol>
</li>
</ol>
<h2 id="变种-x2F-类似"><a href="#变种-x2F-类似" class="headerlink" title="变种&#x2F;类似"></a>变种&#x2F;类似</h2><hr>
<p>由于其创新性的结构和优越的性能，Transformer不仅在自然语言处理领域广泛应用，还在其他领域如图像处理等取得了成功。其中，BERT（Bidirectional Encoder Representations from Transformers）和GPT（Generative Pre-trained Transformer）等模型是 Transformer 模型的重要变种。</p>
<p>Transformer 和 autoencoder 是两种不同的神经网络架构，但它们都属于深度学习领域，并在不同的应用中发挥重要作用。</p>
<ol>
<li><p><strong>共同点：</strong></p>
<ul>
<li><strong>特征学习：</strong> 两者都具有学习数据中有用特征的能力。Autoencoder 通过编码器学习数据的低维表示，而 Transformer 通过注意力机制在输入序列中学习有用的特征。</li>
<li><strong>无监督学习：</strong> Autoencoder 是一种无监督学习模型，而 Transformer 通常用于监督和无监督学习任务，如机器翻译和语言建模。</li>
</ul>
</li>
<li><p><strong>区别：</strong></p>
<ul>
<li><strong>架构设计：</strong> Autoencoder 通常由编码器和解码器组成，其中编码器将输入数据映射到潜在表示，解码器将潜在表示还原为原始数据。而 Transformer 包含编码器和解码器，但其结构更加复杂，引入了自注意力机制，允许并行处理序列数据。</li>
<li><strong>任务应用：</strong> Autoencoder 主要用于数据降维、特征学习和生成模型。它在图像去噪、数据压缩等方面有广泛应用。而 Transformer 在自然语言处理领域表现出色，特别是在机器翻译、文本生成等任务中取得了显著成果。</li>
</ul>
</li>
</ol>
<h3 id="itransformer"><a href="#itransformer" class="headerlink" title="itransformer"></a>itransformer</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/list/watchlater?oid=1803662043&bvid=BV1bb421Y7ZF&spm_id_from=333.999.top_right_bar_window_view_later.content.click">iTransformer讲了一个什么改进模型的思路？-赤页-稍后再看-哔哩哔哩视频 (bilibili.com)</a></li>
<li>有多个模态signal，transformer是竖着切某个时间点，每个时间点的多个变量，给token，但失去了前后历史信息，itransformer横着将整个signal放进去， crosstransformer用patch块状的形式</li>
</ul>
<h1 id="code"><a href="#code" class="headerlink" title="code"></a>code</h1><p><a target="_blank" rel="noopener" href="https://github.com/yolish/har-with-imu-transformer/tree/main">yolish&#x2F;har-with-imu-transformer: Intertial-based Human Activity Recognition with Transformers (github.com)</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://chierhy.github.io">神经蛙</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://chierhy.github.io/2023/11/20/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/model-Transformer/">https://chierhy.github.io/2023/11/20/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/model-Transformer/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://chierhy.github.io" target="_blank">chiblog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0%F0%9F%8E%AB/">笔记🎫</a></div><div class="post_share"><div class="social-share" data-image="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/20/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/model-encoder/"><img class="prev-cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">encoder</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/11/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/method-%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"><img class="next-cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">联邦学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/02/05/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/16-Quantum%20Machine%20Learning/" title="Quantum Machine Learning"><img class="cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-05</div><div class="title">Quantum Machine Learning</div></div></a></div><div><a href="/2023/02/25/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/18-Pytorch-1-%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/" title="Pytorch-1-入门笔记"><img class="cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-25</div><div class="title">Pytorch-1-入门笔记</div></div></a></div><div><a href="/2023/03/03/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/19-pytorch-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="pytorch-2-深度学习"><img class="cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">pytorch-2-深度学习</div></div></a></div><div><a href="/2023/03/03/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/20-pytorch-3-%E5%8F%AF%E8%A7%86%E5%8C%96/" title="pytorch-3-可视化"><img class="cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">pytorch-3-可视化</div></div></a></div><div><a href="/2022/11/17/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="深度学习"><img class="cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-17</div><div class="title">深度学习</div></div></a></div><div><a href="/2023/09/12/%E7%94%9F%E6%B4%BB/%E6%88%91%E8%AF%BB=%E8%99%9A%E6%8B%9F%E6%98%BE%E7%A4%BA%EF%BC%9A%E5%BC%95%E9%A2%86%E6%9C%AA%E6%9D%A5%E7%9A%84%E4%BA%BA%E6%9C%BA%E4%BA%A4%E4%BA%92%E9%9D%A9%E5%91%BD/" title="我读&#x3D;虚拟显示：引领未来的人机交互革命"><img class="cover" src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-12</div><div class="title">我读&#x3D;虚拟显示：引领未来的人机交互革命</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://github.com/chierhy/chierhy.github.io/blob/master/%E9%99%84%E4%BB%B6/1.jpg?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">神经蛙</div><div class="author-info__description">chierhy@163.com</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">120</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/chierhy"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">面试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ans"><span class="toc-number">1.1.</span> <span class="toc-text">ans</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Transformer"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">Transformer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BERT"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">BERT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Transformer%E5%8F%A5%E5%AD%90%E7%94%9F%E6%88%90"><span class="toc-number">1.1.0.3.</span> <span class="toc-text">Transformer句子生成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%8A%9B%E8%AE%A1%E7%AE%97"><span class="toc-number">1.1.0.4.</span> <span class="toc-text">注意力计算</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E7%A7%8D-x2F-%E7%B1%BB%E4%BC%BC"><span class="toc-number">2.1.</span> <span class="toc-text">变种&#x2F;类似</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#itransformer"><span class="toc-number">2.1.1.</span> <span class="toc-text">itransformer</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#code"><span class="toc-number">3.</span> <span class="toc-text">code</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/12/%E6%8A%80%E6%9C%AF%E5%B7%A5%E5%85%B7/1-%E6%9C%8D%E5%8A%A1%E5%99%A8-GPU/" title="服务器-GPU"><img src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="服务器-GPU"/></a><div class="content"><a class="title" href="/2025/04/12/%E6%8A%80%E6%9C%AF%E5%B7%A5%E5%85%B7/1-%E6%9C%8D%E5%8A%A1%E5%99%A8-GPU/" title="服务器-GPU">服务器-GPU</a><time datetime="2025-04-12T09:49:28.477Z" title="发表于 2025-04-12 17:49:28">2025-04-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/12/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/method-%E7%9F%A5%E8%AF%86%E8%92%B8%E9%A6%8F/" title="method-知识蒸馏"><img src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="method-知识蒸馏"/></a><div class="content"><a class="title" href="/2025/04/12/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%9E%8B/method-%E7%9F%A5%E8%AF%86%E8%92%B8%E9%A6%8F/" title="method-知识蒸馏">method-知识蒸馏</a><time datetime="2025-04-12T09:49:26.684Z" title="发表于 2025-04-12 17:49:26">2025-04-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/12/7/" title="无题"><img src="https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2025/04/12/7/" title="无题">无题</a><time datetime="2025-04-12T09:48:44.496Z" title="发表于 2025-04-12 17:48:44">2025-04-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://pic2.zhimg.com/v2-d29a9ed9425ed9aae1d78cd5e9f3a9f1_r.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By 神经蛙</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">See you!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>